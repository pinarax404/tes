<!DOCTYPE html>
<html>
<head>
    <title>ADB Controller</title>
    <meta name="viewport" content="initial-scale=0">
    <link rel="stylesheet" href="css/bootstrap.min.css" type="text/css" />
	<link rel="stylesheet" href="css/font-awesome.min.css">
    <script src="js/jquery.min.js"></script>
    <script src="js/bootstrap.min.js" type="text/javascript"></script>
	<style>
		body {
			background-color: buttonface;
			font-family: verdana;
			font-size: 8pt;
			margin-top: 0px;
			margin-left: 10px;
			margin-right: 10px;
			margin-bottom: 10px;
		}
	</style>
</head>
<body onload="btnLoad()">
	<div style="margin-top: 10px; margin-left: auto; margin-right: auto; width: 380px; border: 1px solid #E3E3E3; padding: 10px; background-color: #F9F9F9; text-align: center;">
		<b style="float: left;">ADB > Connect 192.168.42.129:3000</b>
		<hr style="border: 1px solid red;">
		<div id="btn-atas">
			<button type="button" class="btn" style="width: 110px; height: 105px; border-radius: 20px;">
				<i class="fa fa-signal" id="mobile_data_icon" style="font-size: 48px; color: black"></i>
				<p style="font-weight: bold; font-size: 12px; margin-top: 5px;">Mobile<br>data</p>
			</button>
			<button type="button" class="btn" style="width: 110px; height: 105px; border-radius: 20px; margin-left: 5px;">
				<i class="fa fa-wifi" id="wifi_icon" style="font-size: 48px; color: black"></i>
				<p style="font-weight: bold; font-size: 12px; margin-top: 5px;">Wifi</p>
			</button>
			<button type="button" class="btn" style="width: 110px; height: 105px; border-radius: 20px; margin-left: 5px;">
				<i class="fa fa-plane" id="airplane_mode_icon" style="font-size: 48px; color: black"></i>
				<p style="font-weight: bold; font-size: 12px; margin-top: 5px;">Airplane<br>Mode</p>
			</button>
		</div>
		<hr>
		<span type="button" class="btn btn-white w-100 align-items-stretch d-flex" style="width: 358px; background-color: #EBEBEB;">
			<b style="float: left;">Battery</b>
			<b id="battery" style="float: right;">--</b>
		</span>
		<span type="button" class="btn btn-white w-100 align-items-stretch d-flex" style="width: 358px; background-color: #EBEBEB;">
			<b style="float: left;">Connection</b>
			<b style="float: right;">--</b>
		</span>
	</div>
	<script type="text/javascript">
		const updateBTN = (json) => {
			let html = `<button type="button" class="btn" name="mobile_data" id="${json.mobile_data.id}" style="width: 110px; height: 105px; border-radius: 20px;">`;
				html += `<i class="fa fa-signal" style="font-size: 48px; color: ${json.mobile_data.color};"></i>`;
				html += `<p style="font-weight: bold; font-size: 12px; margin-top: 5px;">Mobile<br>data</p>`;
				html += `</button>`;
				html += `<button type="button" class="btn" name="wifi" id="${json.wifi.id}" style="width: 110px; height: 105px; border-radius: 20px; margin-left: 8px;">`;
				html += `<i class="fa fa-wifi" style="font-size: 48px; color: ${json.wifi.color};"></i>`;
				html += `<p style="font-weight: bold; font-size: 12px; margin-top: 5px;">Wifi</p>`;
				html += `</button>`;
				html += `<button type="button" class="btn" name="airplane" id="${json.airplane.id}" style="width: 110px; height: 105px; border-radius: 20px; margin-left: 8px;">`;
				html += `<i class="fa fa-plane" style="font-size: 48px; color: ${json.airplane.color};"></i>`;
				html += `<p style="font-weight: bold; font-size: 12px; margin-top: 5px;">Airplane<br>Mode</p>`;
				html += `</button>`;
			document.getElementById('btn-atas').innerHTML = html;
		}

		const btnLoad = () => {
			$.getJSON('/buttonAttr', function(res) {
				const mobile_data_id = res.mobile_data.power === 'on' ? 'off' : 'on';
				const mobile_data_color = res.mobile_data.power === 'on' ? 'dodgerblue' : 'black';
				const wifi_id = res.wifi.power === 'on' ? 'off' : 'on';
				const wifi_color = res.wifi.power === 'on' ? 'dodgerblue' : 'black';
				const airplane_id = res.airplane.power === 'on' ? 'off' : 'on';
				const airplane_color = res.airplane.power === 'on' ? 'dodgerblue' : 'black';
				updateBTN({mobile_data: {id: mobile_data_id, color: mobile_data_color}, wifi: {id: wifi_id, color: wifi_color}, airplane: {id: airplane_id, color: airplane_color}})
			});

			$.getJSON('/battery', function(res) {
				document.getElementById('battery').innerHTML = res.battery.value;
			});
		}

		$(document).on('click', '[name="mobile_data"]', function() {
			const onOff = this.id;
			document.getElementsByName('mobile_data')[0].setAttribute('disabled', '');
			$.post('/mobile_data', {'set': onOff}, function() {
				btnLoad();
			});
		});
	</script>
</body>
</html>
